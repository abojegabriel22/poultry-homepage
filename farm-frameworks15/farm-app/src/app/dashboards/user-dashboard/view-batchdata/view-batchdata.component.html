<section class="admin pb-5">
  <div class="container overflow-hidden">
    <div class="row pt-3">
      <div class="col-md-7">
        <!-- Display admin's batches for selection -->
        <div class="col-12 pinkColor p-3 mt-3 margin-small-sc" data-aos="fade-down" data-aos-duration="800">
          <h4 class="smallH4 text-white" data-aos="fade-right" data-aos-duration="800">Purchases belonging to this Batch</h4>

          <!-- Loader -->
          <div *ngIf="loader" class="text-center my-3" data-aos="fade-up" data-aos-duration="800">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2 text-white">Fetching Purchases...</p>
          </div>

          <!-- Error -->
          <div *ngIf="purchaseErrorMessage && !loader" class="alert alert-danger text-center" data-aos="fade-up" data-aos-duration="800">
            {{ purchaseErrorMessage }}
          </div>

          <ul *ngIf="!loader && purchases.length > 0" class="list-group">
            <div class="row">
              <li 
                *ngFor="let purchase of purchases; let i = index"
                class="list-group-item d-flex flex-column flex-md-row justify-content-between align-items-start borderListing shadow mb-3"
              >
                <div class="col-md-9">
                  <strong class="smallText d-block shadow" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*100">
                    {{ purchase.batchId.name }}
                  </strong><br>

                  <small class="smallText" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*200">
                    <strong>Batch Id:</strong>
                    <span class="text-primary">{{ purchase.batchId._id }}</span>
                  </small><br>

                  <small class="smallText" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*300">
                    <strong>Batch Name:</strong>
                    <span class="text-primary">{{ purchase.batchId.name }}</span>
                  </small><br>

                  <small class="smallText" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*400">
                    <strong>Bought:</strong>
                    <span class="text-primary">{{ purchase.quantity }} birds</span>
                  </small><br>

                  <small class="smallText" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*500">
                    <strong>Total Price:</strong>
                    <span class="text-primary">₦{{ purchase.price | number }}</span>
                  </small><br>

                  <small class="smallText" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*600">
                    <strong>Price/Chick:</strong>
                    <span class="text-primary">₦{{ purchase.pricePerChick | number:'1.2-2' }}</span>
                  </small><br>

                  <small class="smallText" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*700">
                    <strong>Date of Purchase:</strong>
                    <span class="text-primary">{{ purchase.dateOfPurchaseFormatted }}</span>
                  </small><br>

                  <small class="smallText" data-aos="fade-right" data-aos-duration="800" [attr.data-aos-delay]="i*800">
                    <strong>Days Since Purchase:</strong>
                    <span class="text-primary">{{ purchase.daysSincePurchase }} days ago</span>
                  </small><br>
                </div>

                <!-- Buttons -->
                <div class="mt-3 mt-md-0 d-flex justify-content-md-end w-100 gap-2" data-aos="zoom-in" data-aos-duration="800" [attr.data-aos-delay]="i*260">
                  <button
                    class="btn btn-sm btn-primary smallText flex-fill flex-md-grow-0 button-size"
                    nz-popconfirm
                    nzPopconfirmTitle="You are about to navigate to view this current purchase data"
                    (nzOnConfirm)="confirm(purchase.batchId._id)"
                    (nzOnCancel)="cancel()"
                    nzPopconfirmPlacement="top"
                    nz-button
                  >
                    Select
                  </button>
                </div>
              </li>

            </div>
          </ul>

          <div data-aos="fade-up" data-aos-duration="800">
            <span class="text-white">{{ currentDate | date: "medium" }}</span>
          </div>
        </div>
      </div>

      <div class="col-md-5 padding-form" data-aos="fade-left" data-aos-duration="800">
        <button class="btn btn-info w-100" (click)="goBack()">Go back</button>
      </div>
    </div>
  </div>
</section>
<app-footer></app-footer>
