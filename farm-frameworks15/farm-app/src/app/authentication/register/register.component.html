<div class="home fade-in-container">
  <div class="overlay"></div>
  <div class="container mb-bottom pb-5 mt-5 pt-4">
    <h1 class="text-center pt-5 fade-item" style="animation-delay: 0.1s">REGISTER</h1>
    <h1 class="text-center fade-item" style="animation-delay: 0.2s">Welcome to Poultry Management</h1>
    <p class="text-center pb-5 fade-item" style="animation-delay: 0.3s">Manage your poultry farm efficiently with our comprehensive tools.</p>
    <!-- ///////form //////// -->
    <div class="d-flex justify-content-center align-items-center vh-50 fade-item" style="animation-delay: 0.4s">
      <!-- // form ///////////////// -->
      <form #form="ngForm" (ngSubmit)="submitForm(form)" class="needs-validation w-100 fade-item" style="max-width: 500px; animation-delay: 0.5s;" novalidate>

        <!-- Success message -->
        <div *ngIf="successMessage" class="alert alert-success text-center fade-item" style="animation-delay: 0.6s">
          {{ successMessage }}
        </div>

        <!-- Error message -->
        <div *ngIf="errorMessage" class="alert alert-danger text-center fade-item" style="animation-delay: 0.7s">
          {{ errorMessage }}
        </div>
        <div class="row">
          <!-- name -->
          <div class="col-md-6 mb-3 fade-item" style="animation-delay: 0.8s">
            <label class="form-label">Name</label>
            <input
              type="text"
              class="form-control"
              name="name"
              [(ngModel)]="user.name"
              required
              #name="ngModel"
              [ngClass]="{ 'is-invalid': name.invalid && name.touched, 'is-valid': name.valid }"
              placeholder="Aboje..."
            />
            <div *ngIf="name.invalid && name.touched" class="invalid-feedback">
              First name is required.
            </div>
          </div>
          <!-- username  -->
          <div class="col-md-6 mb-3 fade-item" style="animation-delay: 0.9s">
            <label for="validationCustomUsername" class="form-label">Username</label>
            <div class="input-group has-validation">
              <span class="input-group-text">@</span>
                <input 
                type="text" 
                class="form-control" 
                name="username"
                [(ngModel)]="user.username"
                #username="ngModel"
                [ngClass]="{ 'is-invalid':username.invalid && username.touched, 'is-valid': username.valid }"
                required 
              />
              <div *ngIf="username.invalid && username.touched" class="invalid-feedback">Please choose a username.</div>
            </div>
          </div>
        </div>
        <div class="row">
          <!-- email  -->
          <div class="col-md-6 mb-3 fade-item" style="animation-delay: 1s">
            <label for="validationCustom02" class="form-label">Email</label>
            <input
            type="email"
              class="form-control"
              name="email"
              [(ngModel)]="user.email"
              #email="ngModel"
              pattern="^([a-zA-Z0-9]+)@([a-zA-Z0-9]+)\.([a-zA-Z0-9]{2,})$"
              [ngClass]="{ 'is-invalid': email.invalid && email.touched, 'is-valid': email.valid }"
              placeholder="ab12@gmail.com"
              required
            />
            <div *ngIf="email.errors?.['patten'] || email.invalid && email.touched" class="invalid-feedback">Please enter a valid email</div>
          </div>
          <!-- password  -->
          <div class="col-md-6 mb-3 fade-item" style="animation-delay: 1.1s">
            <label for="validationCustom02" class="form-label">password</label>
            <input
            type="password"
            class="form-control"
            placeholder="abcdAb12"
            name="password"
            [(ngModel)]="user.password"
            #password="ngModel"
            pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$"
            [ngClass]="{ 'is-invalid': password.invalid && password.touched, 'is-valid': password.valid}"
            required
            />
            <div *ngIf="password.errors?.['pattern'] && password.touched || password.invalid" class="invalid-feedback">Password must be at least 8 characters, contain at least 1 letter and 1 number.</div>
          </div>
        </div>
        <div class="row">
          <!-- confirm password  -->
          <div class="col-md-6 mb-3 fade-item" style="animation-delay: 1.2s">
            <label for="validationCustom02" class="form-label">confirm password</label>
            <input
            type="password"
            class="form-control"
            placeholder="abcdAb12"
            name="confirmPassword"
            [(ngModel)]="user.confirmPassword"
            #confirmPassword="ngModel"
            [ngClass]="{ 'is-invalid': confirmPassword.invalid && confirmPassword.touched, 'is-valid': confirmPassword.valid}"
            required
            />
            <div *ngIf="confirmPassword.invalid && confirmPassword.touched" class="invalid-feedback">Passwords is invalid</div>
            <div *ngIf="user.password && user.confirmPassword && user.password !== user.confirmPassword" class="text-danger">Passwords must match</div>
          </div>
          <!-- role  -->
          <div class="col-md-6 mb-3 fade-item" style="animation-delay: 1.3s">
            <label for="validationCustom04" class="form-label">Role</label>
            <select
            class="form-select"
            name="role"
            [(ngModel)]="user.role"
            required
            #role="ngModel"
            [ngClass]="{ 'is-invalid': role.invalid && role.touched, 'is-valid': role.valid }"
            >
              <option selected disabled value="">default role</option>
              <option value="admin">admin</option>
              <option value="user">viewer</option>
            </select>
            <div *ngIf="role.invalid && role.touched" class="invalid-feedback">Please select a role.</div>
          </div>
        </div>

        <button class="btn btn-primary w-100 fade-item" type="submit" [disabled]="form.invalid || user.password !== user.confirmPassword" style="animation-delay: 1.4s">
          <!-- {{ isLoading ? 'Creating account...' : 'Create Account' }} -->
          <ng-container *ngIf="!isLoading; else loadingTpl">
            Create Account
          </ng-container>

          <ng-template #loadingTpl>
            <span class="spinner-grow spinner-grow-sm me-2" aria-hidden="true"></span>
            Processing...
          </ng-template>
        </button>
        <div class="row">
          <div class="mb-3">
          <!-- navigate to login if you have an account  -->
          <div class="text-center mt-3 fade-item" style="animation-delay: 1.5s">
            <p>Already have an account? <a class="shadow-login" routerLink="/login">Login here</a></p>
          </div> 
        </div>
      </div>
      </form>
  </div>
</div>